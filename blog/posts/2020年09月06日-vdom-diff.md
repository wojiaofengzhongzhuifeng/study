## 知识点

- 直接操作 dom 非常耗费性能

- js 运算非常快

- 能不能使用 js 的对象（虚拟 dom）模拟真实 dom， 在合适的时机根据虚拟 dom 与 真实 dom 做对比（diff），更新真实 dom 

- 树 diff 算法不可取

  - 第一次遍历 tree 1， 需要 n 
  - 第二次遍历 tree2，需要 n
  - 第三次排序，需要 n
  - 假设有 1000 节点，需要 1000 * 1000 * 1000 = 1 亿次

- 将复杂度从 n^3 降低为 n 的优化方法

  - 只比较同一层，不跨级比较（tree diff ）

  - tag（标签，比如span div p） 不相同，直接删除，不深度比较（component diff）

    ![image-20200906111009858](https://raw.githubusercontent.com/wojiaofengzhongzhuifeng/iamge-host-2/master/image-20200906111009858.png)

  - tag 和 key 都相同，认为相同节点，不深度比较（element diff）

- 流程
  - 生成 vdom1
  - vdom1 被修改了，生成 vdom2
  - vdom1与 vdom2 使用「经过优化的 diff 算法」进行比较
  - 变更的部分通过 patch 函数进行更新