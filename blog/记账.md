# 记账

## 笔记

- 两个页面：首页，编辑（新建）页

- ui 组件（展示组件）：传入数据和「回调函数」，在恰当时机执行回调函数；

- 在容器组件中注册这个回调。能拿到ui组件的数据

- 目录结构 

![](https://raw.githubusercontent.com/wojiaofengzhongzhuifeng/image-host/master/img/20190614133350.png)

- p3： priceList UI组件的编写

- p4: 12:50 编写一个 proptypes

- 首页的组件结构

![](https://raw.githubusercontent.com/wojiaofengzhongzhuifeng/image-host/master/img/20190614142237.png)

- 编写组件的流程

  1. 手绘组件树

  1. 确认 ui 组件 + 编写 ui 组件
  
    1. 输入的数据是什么？
    
    2. 传入回调函数是什么？
  
  2. 将 ui 组件合并成一个容器组件
  
  3. 在容器组件中添加逻辑
  
- p9：25：00 enzyme 配置

- p9: 52 完成测试用例

- price 数据的进化过程 https://jsbin.com/muroyekiko/1/edit?js,console

  1. 深层的对象嵌套划分为多个单层的对象嵌套。
  
  2. 数组转化为对象
  
- 将「数据」与「操作数据函数」放到app中，通过 context 传递给 App 内任意一个组件

- HOC：解决组件逻辑重用，创建 withContext.js

- App 组件 this.state 保存的是数据，this.action保存的是操作数据的方法，这两个都要通过 props 传给任意一个子组件

- 代码组件优化过程

  1. 发现 home.js 与 create.js 使用相同的数据 => 将数据提升到 App 中
  
  2. 数据已经提升到 App 中，需要一层层通过 props 传递数据 => context + HOC 使得任意一层的组件都能拿到 App 的数据
  
- 使用 postMan 如何发送请求数据？

![](https://raw.githubusercontent.com/wojiaofengzhongzhuifeng/image-host/master/img/20190618175739.png)

## 重点

- 使用高阶函数 + context 的思想，完成 react 的数据流动

- 项目代码过程

  1. 构建组件结构
  
  2. 标明 ui 组件的功能
  
  3. 根据功能，构建数据，并且将数据保存到最近的 container 组件中
  
  
## 重新写遇到的问题

- 如何按需加载？

![](https://raw.githubusercontent.com/wojiaofengzhongzhuifeng/image-host/master/img/20190620205302.png)

按照提示，还是无法按需加载，原因是什么？

上面的配置是对 webpack 的配置，但是我是用 create-react-app 搭建的项目，webpack的配置被隐藏了，所以要覆盖webpack配置

![](https://raw.githubusercontent.com/wojiaofengzhongzhuifeng/image-host/master/img/20190620211925.png)

- WithContext.js 中，函数 withContext 的作用：是一个函数，接受一个组件，返回一个新组件，在返回新组件之前，可以执行某些代码，使得所有经过withContext包裹的新组件都能执行这段代码

- 使用 iconfont 要去色，才能添加 color 属性

- 几种函数监听区别

![](https://raw.githubusercontent.com/wojiaofengzhongzhuifeng/image-host/master/img/20190621190522.png)

- 控制支出/收入tab，是根据item对应的cid计算出来的

## 需要做的事情

- 添加 改， 删， 完毕的提示

- 数据正在请求时，展示loading

- 应用上线（持久化数据）

