## 2022.08.01 周一

### todo

- ✅ OKR
- 计划本 Q 
- 简单实施文档
- ✅ console 合规化
- ✅ 如何找到 cdn 资源对应的桶位置？

---

### 计划本 Q4

学会东西：

- 爬取评论能力
- sprintboot 后台管理系统

每周计划：

- 8 月第一周(W31)
  - 数据看板开发1/2
  - 【学习计划】简单的实施文档
  - 【学习计划】nest 增删改查，单表
  - 【学习计划】sprint boot 增删改查，单表
  - 【学习计划】准备 sprint boot 的开发
- 8 月第二周(W32)
  - 数据看板开发2/2
  - 【学习计划】看典型代码
  - 【学习计划】看典型代码
- 8 月第三周(W33)
  - 输出评论实施文档
  - 【学习计划】看典型代码
- 8 月第四周(W34)
  - 完成增删改查接口 1/2 
- 8 月第五周(W35)
  - 完成增删改查接口 2/2 
- 9 月第一周(W36)
  - 歌曲爬取 1/3 
- 9 月第二周(W37)
  - 歌曲爬取 2/3
- 9 月第三周(W38)
  - 歌曲爬取 3/3
  - 联通爬取和增删改查接口
    - 需要新增工作表，用于管理歌曲评论入库
    - 至少需要完成[第一个业务接口](https://docs.google.com/document/d/1J2RXijTApUWhImh_rHGaVxd4V20UxhgATAAd4ST0qnE/edit#heading=h.er7x4h8fh7fe)
- 9 月第四周(W39)
  - 前端开发 1/2
- 10 月第一周(W40)
  - 放假
- 10 月第二周(W41)
  - 前端开发 2/2
- 10 月第三周(W42)
  - 评论数据看板
- 10 月第四周(W43)

重要节点：

- 08.11 数据看板完成
- 08.18 评论实施文档
- 09.01 评论数据增删改查接口 （sprint boot）
- 09.15 爬取接口
- 09.22 爬虫 + 增删改查接口一起使用，跑出原数据
- 10.13 上线前端界面
- 10.20 or 10.27 上线评论的数据看板

问题：

- 典型代码推荐？

- 需要引入包的流程？

- 数据库，应该设计成单表还是多表？

  - 多表

    song_comment_map

    id / youtubeId / commentId / status

    comment

    id / likeNumber / username / avatarUrl

  - 单表

    song_comment

    id / youtubeId / status / likeNumber / username / avatar

- 如果新增字段，哪种表更好？



---

### 简单实施文档

https://docs.google.com/document/d/1J2RXijTApUWhImh_rHGaVxd4V20UxhgATAAd4ST0qnE/edit#heading=h.wu6l34v8tkr7



---



### 【新知识】如何找到 cdn 资源对应的桶位置？

- 需求：需要对官网图片进行替换

  ![image-20220801115133797](https://raw.githubusercontent.com/wojiaofengzhongzhuifeng/iamge-host-2/master/image-20220801115133797.png)

- 实现步骤

  - 复制域名

    static.snaptube.in

  - 在 https://us-east-1.console.aws.amazon.com/cloudfront/v3/home?region=us-east-1#/distributions 使用域名进行搜索，得到源

    ![image-20220801115249641](https://raw.githubusercontent.com/wojiaofengzhongzhuifeng/iamge-host-2/master/image-20220801115249641.png)

  - 复制源的部分内容

    us-east-web-static

    在 https://s3.console.aws.amazon.com/s3/buckets?region=us-east-1&region=us-east-1 进行搜索，得到桶

    ![image-20220801115348939](https://raw.githubusercontent.com/wojiaofengzhongzhuifeng/iamge-host-2/master/image-20220801115348939.png)

    

## 2022.08.01 周二

### todo

- ✅ 评论实施文档 、 【新思路】excel 模拟演示数据库 、 使用 nest 完成开发 1/2
- ✅ AUDIT_AFTER_EDIT 处理
- ✅ 上线权限
- ✅ 数据看板需求

---

### 评论实施文档 、 excel 模拟演示数据库 、 使用 nest 完成开发

- 【疑问】关系数据如何保存？

  - 一对多 => 使用外键关联，保存在多方
  - 多对多 => 使用中间表关联，保存在中间表

- 【疑问】评论需要接入包管理机制吗？

- 【疑问】java 调用爬虫接口，获取大量评论数据 1，将数据 1 入库，得到数据 2，数据 1 有没有可能比数据 2 少？需要记录？

- 【持续优化】后端写接口流程

  整个后端接口使用 try catch 包裹，通过抛出异常的方式解决异常情况

  - controller 获取请求参数
    - 校验请求参数：使用 DTO 数据校验请求参数是否符合预期
  - service 使用请求参数
  - 返回响应数据
    - 使用 VO 定义响应数据结构

- for 循环使用

  - 找到第一个不符合条件 i
  - i - 1

- 【疑问】VO 是什么？

  view object 表示返回给前端的数据结构定义

- nest 完成开发 commit message

  - 快速生成单表操作模板代码
  - typeorm 连接数据库
  - 使用 typeorm 操作数据库

- 【存疑】如何定义 nest 的 column status 为 enum ？

- 

---

### 数据看板需求

- 用户可以选择一个时间或者两个时间 + 任务类型  + 分区
-  选择一个时间 =》 查看时间的数据
  - 制作总量（累积量）
  - top 覆盖度（当周的情况）
  - excel 其他数据的情况，注意区分需要获取累计量还是当周量

- 

---

### 上线权限

- 7：30 上
- 出现问题两种解决方案
  - 联系超级管理员
  - 重新将包分配给相关的人

---

## 2022.08.03 周三

### todo

- nest 、 sprintboot 完成 comment  + commentTask 数据表的操作，一共完成 comment 增删改查 4 个接口
- ✅ andy 问题
- AUDIT_AFTER_EDIT  andy 
- 思考如何实现增量
- all hands
- 租房
- ~~andy 数据看板优化~~
- 数据看板第一期需求确定



---

### AUDIT_AFTER_EDIT  andy 

- 假设一个

---

### 思考如何实现增量

用户批量将yid 数据放到 commentTask 表，使用另一个服务不断查询 commentTask  表status === pending的数据，然后执行入库操作



---

### all hands

- 低垂果实



### 租房

- 租多久？
- 最重要不吵
- 位置关注下一家





---

### andy 数据看板优化

- 每日制作
- 分区歌曲，in ES there are 1000 songs, 10% pending, 20% pending audit, 70% done. 



---

### 数据看板第一期需求确定

---



### 2022.08.04 周四

### todo

- commentTaskList 增删改查 4 个接口
- 