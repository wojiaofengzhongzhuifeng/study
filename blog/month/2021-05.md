

## 2021.05.13

### 培训材料

1. 克隆一个摄像头
2. 点击两个摄像头，分别展示不同的监控直播流



## <center>test</center>

## word



## 2021.05.12



## 2021.05.11

### webpack 优化方式

- Dll

  - 解决思路

    将不做修改的依赖文件（React），提前打包，这样我们打包的时候，就不需要对这部分代码进行打包，节省打包时间

  - 解决步骤

    - 使用 DllPlugin 打包生成 react_dll.js 与 manifest.json

      ```javascript
      // 文件目录：configs/webpack.dll.js
      'use strict';
      
      const path = require('path');
      const webpack = require('webpack');
      
      module.exports = {
          mode: 'production',
          entry: {
              react: ['react', 'react-dom'],
          },
          // 这个是输出 dll 文件
          output: {
              path: path.resolve(__dirname, '../dll'),
              filename: '_dll_[name].js',
              library: '_dll_[name]',
          },
          // 这个是输出映射表
          plugins: [
              new webpack.DllPlugin({ 
                  name: '_dll_[name]', // name === output.library
                  path: path.resolve(__dirname, '../dll/[name].manifest.json'),
              })
          ]
      };
      ```

    - 使用 DllReferencePlugin 链接 dll 文件，使用 AddAssetHtmlPlugin 将 _dll_react.js 挂载到 HTML

      ```javascript
      // 文件目录：configs/webpack.common.js
      
      const path = require('path');
      const AddAssetHtmlPlugin = require('add-asset-html-webpack-plugin'); // 顾名思义，把资源加到 html 里，那这个插件把 dll 加入到 index.html 里
      const webpack = require('webpack');
      module.exports = {
        // ......
        plugins: [
          new webpack.DllReferencePlugin({
            // 注意: DllReferencePlugin 的 context 必须和 package.json 的同级目录，要不然会链接失败
            context: path.resolve(__dirname, '../'),
            manifest: path.resolve(__dirname, '../dll/react.manifest.json'),
          }),
          new AddAssetHtmlPlugin({
            filepath: path.resolve(__dirname, '../dll/_dll_react.js'),
          }),
        ]
      }
      
      ```

      

- js 代码分割（splitChunksPlugin）常用方法

  - 使用 entry 配置手动分离代码

    手动配置多入口实现代码分割，多入口打包抽取公共代码

    webpack 内置 splitChunksPlugin ，使用这个插件解决文件内容重复问题

    现有 main.js 与 other.js ，其中两个文件都是使用了 jquery（实现了多入口 js，但是带来了js 文件内容重复的问题）

    webpack.config.js 添加以下配置

    ```javascript
    optimization:{
    	splitChunks: { // 实际就是 splitChunksPlugin 插件的配置
    		chunks: "all"
    	}
    }
    ```

    | 优化之前打包后生成的文件                                     | 优化之后打包后生成的文件                                     |
    | ------------------------------------------------------------ | ------------------------------------------------------------ |
    | 1. other.bundle.js（包含 jquery 源代码）<br />2. main.bundle.js（包含 jquery 源代码） | 1. other.bundle.js<br />2. main.bundle.js<br />3. vendors~main-other.bundle.js(包含 juqery 源代码)<br /> |

    

  - 动态导入（懒加载）

    希望在使用 import/exoprt 语法的时候，可以使用条件判断。
    但是直接写会报错，所以使用动态导入的语法，实现条件判断，进而实现模块的动态导入。

    |        | import/export 导入模块语法           | 动态导入模块语法                                 |
    | ------ | ------------------------------------ | ------------------------------------------------ |
    | 示例   | import $ from 'jquery'               | import('jquery').then((default: $)=>{})          |
    | 注意点 | 只能放到文件最顶级，不允许有条件判断 | 1. 返回一个 promise<br />2. 可以在条件判断中运行 |

    在 react 中，使用 React.lazy + Suspense 实现动态加载

- IgnorePlugin
  - 背景

    安装 moment 这个库，如果不做任何优化，打包后的代码会变非常大。

  - 解决思路

    打包后代码变的非常大的原因是 moment 支持国际化，会有其他语言的代码，实际上是不需要的，需要在打包过程中删除所有语言，然后手动引入需要的语言

  - 解决步骤

    - 通过查看源代码的方式，确定 moment 库依赖的语言包

    - webpack.config.js 使用 IgnorePlugin 插件忽略 moment 依赖的语言包

      ```javascript
      new Webpack.IgnorePlugin(/\.\/locale/, /moment/)
      ```

    - 使用 moment 时手动引入语言包

      ```javascript
      import moment from 'moment'
      import 'moment/locale/zh-cn'
      moment.locale('zh-cn')
      ```

      

    

- noParse（阻止 webpack 分析第三方库的依赖关系）

  项目在使用第三方库（jquery），并且做了打包操作。那么 webpack 会在打包的过程中，尝试寻找 jquery 的依赖关系。但是这样做是没有意义的，需要阻止这个过程。

  在 webpack.config.js 中，在 modules 中添加

  ```javascript
  module:{
  	noParse: /jquery|bootstrap/
  }
  ```

- loader 配置添加 include/excludes 属性

  ```diff
  module:{
  	noParse: /jquery|bootstrap/,
  	rules:[
  	 {
  	 	test: /\.js$/,
  	 	use: {
  	 		loader: 'babel-loader'
  	 	},
  +	 	excludes: /node_modules/,
  +	 	includes: path.resolve(__dirname, './src')
  	 }
  	]
  }
  ```

  

- mode: production 做了什么？
  - tree shaking
  - scope hoisting
  - 代码压缩



### splitChunksPlugin 配置

![image-20210512073226751](https://raw.githubusercontent.com/wojiaofengzhongzhuifeng/iamge-host-2/master/image-20210512073226751.png)







## 2021.05.10



###  二次开发模式 

### 盈嘉的产品与上锅自开发系统如何对接





























## 2021.05.09

### url 输入后发生什么？

- DNS 的解析
  - 浏览器 DNS 缓存
  - 系统  DNS 缓存
  - 运营商 DNS 缓存
  - 递归搜索
- TCP 三次握手
- 发送请求
- 接受响应
- 渲染页面
- TCP 四次挥手

### 浏览器的渲染过程

- 简单过程

  - HTML Parser 将 HTML 解析成 DOM tree
  - CSS Parser 将 CSS 解析出 CSSOM
  - 脚本处理
  - 两者关联生成 Render Tree
  - 布局：Layout 根据 Render Tree 计算节点信息（回流）（reflow）
  - 绘制：Painting 根据计算信息绘制整个页面（repaint）

  

  

### redux /react-redux

- reducer

  纯函数，输入state，action，输出最新的 state

  规范新 state 的创建流程

- action
  对象，告诉全局状态修改什么数据，以及新数据是什么

- dispatch
  函数，输入 action，函数内部执行 setState

  规范 setState 的流程

- connect
  高阶组件， 输入 react 组件1，输出 react 组件2，组件 2 拥有全局状态
  将普通组件与全局状态连接起来

- mapStateToProps

  函数，将全局 state 某些数据传给组件

- mapDispatcherToProps
  函数，输入 dispatch 函数，输出函数，该函数可以运行 dispatch(action)

- connect(mapStateToProps, mapDispatchToProps)(普通组件) 的理解

- createStore(reducer, initState)

  用于创建全局状态



### Cookie vs LocalStorage vs SesstionStorage vs Session









## 2021.05.08

### 面试

- class 组件与 function 组件的区别
- class 组件 this 丢失解决方法
- 为什么 this 会丢失
- hooks 为什么要按照顺序执行？基于什么数据结构？为什么要基于链表？
- mobx 与 redux 的区别？
- redux 的实现原理
- mobx 与 redux 如何更新视图？
- useReducer、mobx、redux如何选择
- 自己写过第三方的 hooks ？
- 做了 webpack 的哪些优化
  - chunk ?
- cookie 与 session 的区别
- 在前端调用其他接口，带上 cookie 信息



### 管理一个新项目

- 基础架构设计

- 工程化设计

  - 前后端联调

    使用 apiDoc 实现

- 

  

## 2021.05.07

### DS 平台学习

- 物项属性 === bos3d 解析得到的属性 + 映射操作 + filter 操作



### package.json script 如何添加变量？

- set

  ```
  "start": "react-scripts start cross-env NODE_ENV=dev",
  ```

- get

  ```
  window.IS_DEV = process.env.NODE_ENV === 'development';
  ```



### DS 权限控制

- 登录权限设置
  - react：新建一个高阶组件，在组件内部进行判断，如果登录，返回组件内容。没有登录，重定向到登录页面
  - vue：使用路由守卫功能
- 页面权限的控制
  后端返回用户的页面权限字段
  - react：使用变量进行判断
  - vue：使用动态路由
- 页面元素权限控制（button，更加精细的操作）
  - react：











## 2021.05.06

###部署文件上传代码

- 后端

  - centos 安装 node，npm

    ```
    curl -sL https://rpm.nodesource.com/setup_14.x | sudo bash -
    sudo yum install nodejs
    ```

  - 代码上传，使用 node index.js 跑起来

    ✅ 发现无法上传文件，初步判断是文件的权限问题导致

    ` sudo chmod 777 upload/` 

    将 upload 的权限改为可读可写可修改

  - 安装pm2 管理 node

  - nginx 配置

- 前端

- ❌后端服务部署是不是有问题？

### create-react-app 生成的 react应用，打包之后如何在 github preview ？

- github 开启github pages

- create-react-app package.json 添加属性，然后再 yarn build

  ```
  "homepage": "."
  ```

- 将 build or dist 从 .gitignore 删除

- git push 















































## 2021.05.04

### 方面试题

- 垂直水平居中：https://jsbin.com/foqapecaxa/1/edit

- flex 使用方法
  align-items: 配置单主轴在交叉轴的位置

  align-content: 配置多主轴在交叉轴的位置

  align-self: 覆盖原有的 align-items 的值

- BFC

  - 是什么
    块级格式化上下文，独立的渲染空间
  - 有什么用
    - 边距重叠问题
    - 盒子塌陷问题
    - 清除浮动
    - 浮动环绕  文字

  







## 2021.05.03

### 冒泡排序

- 思想
  - 前一项与后一项比较谁大谁放后面
- 实现
  https://jsbin.com/qinolanoji/1/edit?js,console,output

### 删除排序数组中的重复项

- 思想

- 实现

  https://leetcode-cn.com/leetbook/read/top-interview-questions-easy/x2gy9m/

- 

## 2021.05.02

### tree 组件

[笔记](./../posts/react/16tree.md#笔记)



## 2021.05.01

