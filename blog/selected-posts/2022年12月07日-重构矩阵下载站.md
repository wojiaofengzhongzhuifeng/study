## 项目简介

该项目是一个使用原生js 、html、css 完成的下载站项目



## 项目存在问题

### 资源加载策略有问题

css 和 js 分散资源多，且资源采用同步加载，渲染时需要多次请求和加载，降低页面加载性能

### 代码未压缩

js 和css 代码未经过压缩

### 开发模式陈旧

需要同时维护html、js、css  





## 项目改造第一阶段：接入 webpack 

### 项目初始化

- 创建 npm 项目

- 安装webpack 依赖

- 创建 js 入口文件

- 创建 + 编写 webpack 配置文件

  ```javascript
  module.exports = {
    entry: path.resolve(__dirname, './src/index.js'),
    output: {
      filename: 'bundle.js', 
    }
  }
  ```

- 注册 build 命令

- 检查打包产物 



### 首页移植

- 资源文件(img、 js、 css、 index.html)拷贝

- 删除index.html的外部引用（link script）

  ![image-20221208152011507](../assets/images/image-20221208152011507.png)

  为什么要这样做？期待 script 与 link 的内容，合并成一个打包后的 script 文件（虽然这个script 的文件会很大，但是可以通过分包策略，优化，目前的目的是将多个分散资源合并成一个）

- 自动管理html 与打包文件引用关系

  使用 html-webpack-plugin 插件，配置如下:

  ```javascript
  module.exports = {
    mode: 'development',
    entry: path.resolve(__dirname, './src/index.js'),
    output: {
      filename: '[hash].js',
    },
    // html-webpack-plugin 配置
    plugins: [new HtmlWebpackPlugin({
      template: path.resolve(__dirname, './src/index.html')
    })],
  }
  ```

  html-webpack-plugin 配置作用

  1. 告诉 html-webpack-plugin ，webpack 会将  `./src/index.html`  文件作为打包后的 html 

  2. 在  `./src/index.html`  中，自动添加打包产物的引入，如上面的配置，会以 `'./src/index.js'` 作为js入口文件，打包生成的js 文件会被放 入到 `./dist/44a0cc5ebb11da97284f.js`，在 index.html 中，会添加这个的引入

     ![image-20221208151357117](../assets/images/image-20221208151357117.png)

- 在入口 js 中，处理css 引用

  - 由于 css 会引用图片资源，所以在处理 css 引用时，也要处理图片资源

    如果是 webpack5，可以使用module.parser 

- 在入口js中，处理 js 引用

- 调整index.html 的图片路径 